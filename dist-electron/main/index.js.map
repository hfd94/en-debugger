{"version":3,"file":"index.js","sources":["../../electron/main/sqlite/index.ts","../../electron/main/index.ts"],"sourcesContent":["import { app } from \"electron\";\r\nimport * as path from \"path\";\r\nimport * as sqlite3 from \"sqlite3\";\r\nimport { queryParam, insertParam, updateParam, deleteParam } from \"./types\";\r\n\r\nconst userDataPath = app.getPath(\"userData\");\r\nconsole.log(userDataPath)\r\nconst dbPath = path.join(userDataPath, \"Storage.bin\");\r\n\r\nconsole.log(\"Database path:\", dbPath);\r\n\r\nclass Database {\r\n    private db: sqlite3.Database;\r\n\r\n    constructor() {\r\n        this.db = new sqlite3.Database(dbPath);\r\n    }\r\n\r\n    open(): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            this.db.serialize(() => {\r\n                this.db.run(\"PRAGMA foreign_keys = ON\");\r\n                console.log(\"Connected to the database.\");\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n\r\n    close(): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            this.db.close((err) => {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    console.log(\"Database closed.\");\r\n                    resolve();\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    query(param: queryParam): Promise<any[]> {\r\n        return new Promise<any[]>((resolve, reject) => {\r\n            this.db.all(param.sql, param.params, (err, rows) => {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    resolve(rows);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    insert(param: insertParam): Promise<number> {\r\n        return new Promise<number>((resolve, reject) => {\r\n            const keys = Object.keys(param.data);\r\n            const values = Object.values(param.data);\r\n            const placeholders = keys.map(() => \"?\").join(\",\");\r\n            const sql = `INSERT INTO ${param.table} (${keys.join(\r\n                \",\"\r\n            )}) VALUES (${placeholders})`;\r\n\r\n            this.db.run(sql, values, function (err) {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    resolve(this.lastID);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    update(param: updateParam): Promise<number> {\r\n        return new Promise<number>((resolve, reject) => {\r\n            const entries = Object.entries(param.data)\r\n                .map(([key, value]) => `${key} = ?`)\r\n                .join(\",\");\r\n            const params = Object.values(param.data);\r\n            const sql = `UPDATE ${param.table} SET ${entries} WHERE ${param.condition}`;\r\n\r\n            this.db.run(sql, params, function (err) {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    resolve(this.changes);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    delete(param: deleteParam): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            const sql = `DELETE FROM ${param.table} WHERE ${param.condition}`;\r\n            console.log(sql)\r\n\r\n            this.db.run(sql, (err) => {\r\n                if (err) {\r\n                    reject(err);\r\n                } else {\r\n                    resolve();\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nconst db = new Database();\r\n\r\nexport const initSqlite = async () => {\r\n    try {\r\n        await db.open();\r\n        await db.query({\r\n            sql: `\r\n            CREATE TABLE IF NOT EXISTS work_menus ( id TEXT PRIMARY KEY, name TEXT NOT NULL, parentId TEXT, type TEXT );\r\n            `\r\n        })\r\n        await db.query({\r\n            sql: `CREATE TABLE IF NOT EXISTS work_panel ( id TEXT PRIMARY KEY, url TEXT NOT NULL, type TEXT,  script TEXT );`\r\n        })\r\n        await db.query({\r\n            sql: `CREATE TABLE IF NOT EXISTS work_quick (id INTEGER PRIMARY KEY AUTOINCREMENT,parentId INTEGER,name TEXT,command TEXT)`\r\n        })\r\n\r\n        await db.query({\r\n            sql: `INSERT INTO work_menus (id, name) VALUES ('1b85da56-5fb6-4d6f-b9b5-295db5530882','测试存放');`\r\n        })\r\n        await db.query({\r\n            sql: `INSERT INTO work_menus (id, name) VALUES ('1b85da56-5fb6-4d6f-b9b5-295db5530881','演示二级目录');`\r\n        })\r\n        await db.query({\r\n            sql: `INSERT INTO work_menus (id, name,parentId) VALUES ('1b85da56-5fb6-4d6f-b9b5-295db5530880','二级目录','1b85da56-5fb6-4d6f-b9b5-295db5530881');`\r\n        })\r\n        await db.query({\r\n            sql: `INSERT INTO work_menus (id, name,parentId,type) VALUES ('1b85da56','WebSocket','1b85da56-5fb6-4d6f-b9b5-295db5530882','websocket');`\r\n        })\r\n        await db.query({\r\n            sql: `INSERT INTO work_menus (id, name,parentId,type) VALUES ('1b85da51','Http-Get','1b85da56-5fb6-4d6f-b9b5-295db5530882','get');`\r\n        })\r\n        await db.query({ sql: `INSERT INTO work_panel (id, url,type) VALUES ('1b85da56','ws://127.0.0.1:3000','websocket');` })\r\n        await db.query({ sql: `INSERT INTO work_panel (id, url,type) VALUES ('1b85da51','http://www.baidu.com','get');` })\r\n        console.log(\"Database initialized.\");\r\n    } catch (err) {\r\n        console.error(\"Error opening database:\", err);\r\n    }\r\n};\r\n\r\nexport const sqQuery = db.query.bind(db);\r\nexport const sqInsert = db.insert.bind(db);\r\nexport const sqUpdate = db.update.bind(db);\r\nexport const sqDelete = db.delete.bind(db);","import { app, BrowserWindow, shell, ipcMain, dialog } from 'electron'\r\nimport { createRequire } from 'node:module'\r\nimport { fileURLToPath } from 'node:url'\r\nimport path from 'node:path'\r\nimport os from 'node:os'\r\nimport { initSqlite, sqDelete, sqInsert, sqQuery } from './sqlite'\r\nimport { randomUUID } from 'node:crypto'\r\n\r\nconst require = createRequire(import.meta.url)\r\nconst __dirname = path.dirname(fileURLToPath(import.meta.url))\r\n\r\nconst HexEditor = \"hex-editor\"\r\n\r\n// The built directory structure\r\n//\r\n// ├─┬ dist-electron\r\n// │ ├─┬ main\r\n// │ │ └── index.js    > Electron-Main\r\n// │ └─┬ preload\r\n// │   └── index.mjs   > Preload-Scripts\r\n// ├─┬ dist\r\n// │ └── index.html    > Electron-Renderer\r\n//\r\nprocess.env.APP_ROOT = path.join(__dirname, '../..')\r\n\r\nexport const MAIN_DIST = path.join(process.env.APP_ROOT, 'dist-electron')\r\nexport const RENDERER_DIST = path.join(process.env.APP_ROOT, 'dist')\r\nexport const VITE_DEV_SERVER_URL = process.env.VITE_DEV_SERVER_URL\r\n\r\nprocess.env.VITE_PUBLIC = VITE_DEV_SERVER_URL\r\n    ? path.join(process.env.APP_ROOT, 'public')\r\n    : RENDERER_DIST\r\n\r\n// Disable GPU Acceleration for Windows 7\r\nif (os.release().startsWith('6.1')) app.disableHardwareAcceleration()\r\n\r\n// Set application name for Windows 10+ notifications\r\nif (process.platform === 'win32') app.setAppUserModelId(app.getName())\r\n\r\nif (!app.requestSingleInstanceLock()) {\r\n    app.quit()\r\n    process.exit(0)\r\n}\r\n\r\nlet win: BrowserWindow | null = null\r\nconst preload = path.join(__dirname, '../preload/index.js')\r\nconst indexHtml = path.join(RENDERER_DIST, 'index.html')\r\n\r\nasync function createWindow() {\r\n    win = new BrowserWindow({\r\n        title: 'Main window',\r\n        autoHideMenuBar: true,\r\n        icon: path.join(process.env.VITE_PUBLIC, 'favicon.ico'),\r\n        width: 1120,\r\n        height: 720,\r\n        minWidth: 1120,\r\n        minHeight: 720,\r\n        frame: false,\r\n        webPreferences: {\r\n            webSecurity: false,\r\n            devTools: true,\r\n            // nodeIntegration: true,\r\n            // contextIsolation: true,\r\n            preload,\r\n            // Warning: Enable nodeIntegration and disable contextIsolation is not secure in production\r\n            // nodeIntegration: true,\r\n\r\n            // Consider using contextBridge.exposeInMainWorld\r\n            // Read more on https://www.electronjs.org/docs/latest/tutorial/context-isolation\r\n            // contextIsolation: false,\r\n        },\r\n    })\r\n\r\n    if (VITE_DEV_SERVER_URL) { // #298\r\n        win.loadURL(VITE_DEV_SERVER_URL)\r\n        // Open devTool if the app is not packaged\r\n        win.webContents.openDevTools()\r\n    } else {\r\n        win.loadURL(`file://${path.join(__dirname, 'index.html')}`);\r\n    }\r\n\r\n    // Test actively push message to the Electron-Renderer\r\n    win.webContents.on('did-finish-load', () => {\r\n        win?.webContents.send('main-process-message', new Date().toLocaleString())\r\n    })\r\n\r\n    // Make all links open with the browser, not with the application\r\n    win.webContents.setWindowOpenHandler(({ url }) => {\r\n        if (url.startsWith('https:')) shell.openExternal(url)\r\n        return { action: 'deny' }\r\n    })\r\n    // win.webContents.on('will-navigate', (event, url) => { }) #344\r\n}\r\n\r\napp.whenReady().then(async () => {\r\n    await initSqlite();\r\n    createWindow();\r\n})\r\n\r\napp.on('window-all-closed', () => {\r\n    win = null\r\n    if (process.platform !== 'darwin') app.quit()\r\n})\r\n\r\napp.on('second-instance', () => {\r\n    if (win) {\r\n        // Focus on the main window if the user tried to open another\r\n        if (win.isMinimized()) win.restore()\r\n        win.focus()\r\n    }\r\n})\r\n\r\napp.on('activate', () => {\r\n    const allWindows = BrowserWindow.getAllWindows()\r\n    if (allWindows.length) {\r\n        allWindows[0].focus()\r\n    } else {\r\n        createWindow()\r\n    }\r\n})\r\nconst subWindows: Record<string, BrowserWindow> = {}\r\n\r\nipcMain.handle('dialog:openFile', async (event) => {\r\n    const result = await dialog.showOpenDialog({\r\n        title: '选择Proto文件',\r\n        filters: [\r\n            { name: 'proto文件', extensions: ['proto'] },\r\n            { name: '所有文件', extensions: ['*'] },\r\n        ],\r\n        properties: ['openFile', 'multiSelections']\r\n    });\r\n\r\n    return result.filePaths; // 返回选中的文件路径\r\n});\r\n\r\n// New window example arg: new windows url\r\nipcMain.handle('open-win', (_, arg) => {\r\n    if (!Object.hasOwn(subWindows, arg)) {\r\n        const childWindow = new BrowserWindow({\r\n            autoHideMenuBar: true,\r\n            frame: false,\r\n            parent: win!,\r\n            webPreferences: {\r\n                preload,\r\n                nodeIntegration: true,   // 允许使用 Node.js 功能\r\n                // contextIsolation: false // 确保渲染进程的 JS 可以访问 Node.js API\r\n            },\r\n        })\r\n\r\n        if (VITE_DEV_SERVER_URL) {\r\n            console.log(`${VITE_DEV_SERVER_URL}#${arg}`)\r\n            childWindow.loadURL(`${VITE_DEV_SERVER_URL}#${arg}`)\r\n        } else {\r\n            childWindow.loadFile(indexHtml, { hash: arg })\r\n        }\r\n        subWindows[arg] = childWindow\r\n    }\r\n\r\n})\r\n\r\n// 如果没有打开HexEditor窗口则打开, 如果打开了则传数据\r\nipcMain.handle(\"open-hex-editor\", (_, args) => {\r\n    let exist = subWindows[HexEditor]\r\n    if (!exist) {\r\n        const childWindow = new BrowserWindow({\r\n            autoHideMenuBar: true,\r\n            frame: false,\r\n            parent: win!,\r\n            webPreferences: {\r\n                preload,\r\n                nodeIntegration: true,   // 允许使用 Node.js 功能\r\n                // contextIsolation: false // 确保渲染进程的 JS 可以访问 Node.js API\r\n            },\r\n        })\r\n\r\n        if (VITE_DEV_SERVER_URL) {\r\n            console.log(`${VITE_DEV_SERVER_URL}#hex-editor`)\r\n            childWindow.loadURL(`${VITE_DEV_SERVER_URL}#hex-editor`)\r\n        } else {\r\n            childWindow.loadFile(indexHtml, { hash: \"hex-editor\" })\r\n        }\r\n        subWindows[HexEditor] = childWindow\r\n        exist = childWindow\r\n        exist.webContents.on('did-finish-load', () => {\r\n            // 通过子窗口的 `webContents.send` 向子窗口发送数据\r\n            exist.webContents.send('data-from-main', { key: args });\r\n        });\r\n    } else {\r\n        exist.webContents.send('data-from-main', { key: args });\r\n    }\r\n\r\n})\r\n\r\nipcMain.on('window-min', function () {\r\n    if (win) {\r\n        win.minimize();\r\n    }\r\n})\r\n\r\nipcMain.on('window-max', function () {\r\n    if (!win) { return }\r\n    if (win.isMaximized()) {\r\n        win.restore();\r\n    } else {\r\n        win.maximize();\r\n    }\r\n})\r\nipcMain.on('window-close', (event: any, ...args) => {\r\n    console.log(args)\r\n    if (args[0]) {\r\n        if (Object.hasOwn(subWindows, args[0])) {\r\n            subWindows[args[0]].close()\r\n            delete (subWindows[args[0]])\r\n        }\r\n    } else {\r\n        if (!win) { return }\r\n        if (process.platform !== 'darwin') app.quit()\r\n    }\r\n})\r\n\r\n\r\nipcMain.handle(\"insert-menu-folder\", async (_, data) => {\r\n    data.id = randomUUID()\r\n    let url = \"\"\r\n    if (data.type) {\r\n        url = data.url\r\n        delete (data.url)\r\n    }\r\n    await sqInsert({ table: \"work_menus\", data })\r\n    if (data.type) {\r\n        await sqInsert({\r\n            table: \"work_panel\", data: {\r\n                id: data.id,\r\n                url: url,\r\n                type: data.type,\r\n            }\r\n        })\r\n    }\r\n\r\n})\r\ninterface Menu {\r\n    id: string,\r\n    name: string\r\n    parentId?: string\r\n    type?: string\r\n    configure?: string\r\n}\r\nconst buildMenuTree = (menus: Menu[]) => {\r\n    const map = new Map();\r\n    const roots: any[] = [];\r\n\r\n    // 初始化每个菜单项\r\n    menus.forEach(menu => {\r\n        // 为每个菜单项创建一个新对象（避免修改原始数据）\r\n        map.set(menu.id, { id: menu.id, title: menu.name, type: menu.type, children: menu.type === null ? [] : null });\r\n    });\r\n\r\n    // 构建层级关系\r\n    menus.forEach(menu => {\r\n        const menuItem = map.get(menu.id);\r\n        if (menu.parentId) {\r\n            // 如果有父节点，将当前节点添加到父节点的 children 中\r\n            const parentItem = map.get(menu.parentId);\r\n            if (parentItem.children !== null) {\r\n                parentItem.children.push(menuItem);\r\n            }\r\n        } else {\r\n            // 如果没有父节点，说明是顶级菜单\r\n            roots.push(menuItem);\r\n        }\r\n    });\r\n\r\n    return roots;\r\n};\r\nipcMain.handle(\"get-work-menus\", async (_, data) => {\r\n    const ret: Array<Menu> = await sqQuery({ sql: `SELECT * FROM work_menus;` })\r\n    const result = buildMenuTree(ret)\r\n    return result\r\n})\r\n\r\n\r\nipcMain.handle(\"delete-menu\", async (_, data: { tab: string[], page: string[] }) => {\r\n    const strs: string[] = []\r\n    data.tab.forEach(v => {\r\n        strs.push(`'${v}'`)\r\n    })\r\n    await sqDelete({ table: \"work_menus\", condition: `id in (${strs.join(',')})` })\r\n\r\n    if (data.page.length > 0) {\r\n        strs.length = 0\r\n        data.page.forEach(v => {\r\n            strs.push(`'${v}'`)\r\n        })\r\n        await sqDelete({ table: \"work_panel\", condition: `id in (${strs.join(',')})` })\r\n    }\r\n})\r\n\r\nipcMain.handle('get-panel-info', async (_, data: { id: string }) => {\r\n    const sql = `SELECT * FROM work_panel where id = '${data.id}';`\r\n    const ret: Array<Menu> = await sqQuery({ sql })\r\n    return ret\r\n})\r\n\r\nipcMain.handle('get-quick-info', async (_, data: { id: string }) => {\r\n    const sql = `SELECT * FROM work_quick where parentId = '${data.id}';`\r\n    const ret: Array<Menu> = await sqQuery({ sql })\r\n    return ret\r\n})"],"names":["app","path","sqlite3","createRequire","__dirname","fileURLToPath","BrowserWindow","shell","ipcMain","dialog","randomUUID"],"mappings":"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"}